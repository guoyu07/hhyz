{% extends 'base.html' %}
{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="row">
                    <div class="col-md-12">
                        <h3>用户信息</h3>
                        <hr>
                    </div>
                </div>
                <form target="_blank" href="#" method="post">
                    <div class="row">
                        <div class="col-md-3 col-md-offset-2">
                            <div class="row">
                                <div class="col-md-12 avatar-now-div">
                                    <img src="{{ current_user.avatar }}" id="avatar-img-now" width="200" height="200">
                                </div>
                            </div>
                            <div class="row margin-top-2">
                                <div class="col-md-9">
                                    {#                                    <button class="btn btn-primary btn-sm center-h" data-toggle="modal"#}
                                    {#                                            data-target="#avatart-modal">修改头像#}
                                    {#                                    </button>#}
                                    <button type="button" class="btn btn-primary btn-sm center-h" data-toggle="modal"
                                            data-target="#avatart-modal">
                                        修改头像
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-5">
                            <div class="row margin-top-1">
                                <div class="col-md-3">
                                    <label class="info-lable">昵称:</label>
                                </div>
                                <div class="col-md-5">
                                    {{ form.name(placeholder='昵称',class=" form-control input-sm",value=current_user.name) }}
                                </div>
                            </div>
                            <div class="row margin-top-1">
                                <div class="col-md-3">
                                    <label class="info-lable">电话:</label>
                                </div>
                                <div class="col-md-5">
                                    {{ form.phone(placeholder='电话',class=" form-control input-sm",value=current_user.phone) }}
                                </div>
                            </div>
                            <div class="row margin-top-1">
                                <div class="col-md-3">
                                    <label class="info-lable">性别:</label>
                                </div>
                                <div class="col-md-5">
                                    {{ form.gender(class=" form-control input-sm",placeholder='性别',value=current_user.gender) }}
                                </div>
                            </div>
                            <div class="row margin-top-1">
                                <div class="col-md-3">
                                    <label class="info-lable">年龄:</label>
                                </div>
                                <div class="col-md-5">
                                    {{ form.age(class=" form-control input-sm",placeholder='年龄',value=current_user.age) }}
                                </div>
                            </div>
                            <div class="row margin-top-1">
                                <div class="col-md-3">
                                    <label class="info-lable">关于我:</label>
                                </div>
                                <div class="col-md-8">
                                    {{ form.about_me(placeholder='关于我',class="form-control",value=current_user.about_me) }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 margin-top-3">
                            {{ form.submit(class="btn btn-primary btn-lg center-h edit-info-btn") }}
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="modal " id="avatart-modal">
        <div class="modal-dialog">
            <div class="modal-content" style="width: 680px">
                <div class="modal-body">
                    <div class="row">

                        <div class="avatar-img-div">
                            <img src="{{ current_user.avatar }}" width="400" height="400" id="avatar-img"
                                 alt="[Jcrop Example]">

                            <div id="preview-pane">
                                <div class="preview-container">
                                    <img src="{{ current_user.avatar }}" class="jcrop-preview" alt="Preview" width="100"
                                         height="100">
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-12 avatar-img-ctrl">
                            <div class="avatar-img-btn">
                                <button class="btn btn-default avatar-img-btn-l" id="avatar-btn-up">上传</button>
                                <input type="file" class="avatar-img-file"/>
                            </div>
                            <div class="avatar-img-btn">
                                <button class="btn btn-primary avatar-img-btn-r" id="avatar-btn-save">保存</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
    <link href="{{ url_for('static',filename='css/jquery.Jcrop.min.css') }}" rel="stylesheet">
    <script src="{{ url_for('static',filename='js/jquery.Jcrop.min.js') }}"></script>
    <script src="{{ url_for('static',filename='js/jquery.fileupload.js') }}"></script>
    <script src="{{ url_for('static',filename='js/jquery.iframe-transport.js') }}"></script>
    <script src="{{ url_for('static',filename='js/jquery.ui.widget.js') }}"></script>
    <script>

    $(function () {
    'use strict';
    // Change this to the location of your server-side upload handler:
    var url = window.location.hostname === 'blueimp.github.io' ?
                '//jquery-file-upload.appspot.com/' : 'server/php/';
    $('.avatar-img-file').fileupload({
        url: url,
        dataType: 'json',
        done: function (e, data) {
            $.each(data.result.files, function (index, file) {
                $('<p/>').text(file.name).appendTo('#files');
            });
        },
        progressall: function (e, data) {
            var progress = parseInt(data.loaded / data.total * 100, 10);
            $('#progress .progress-bar').css(
                'width',
                progress + '%'
            );
        }
    }).prop('disabled', !$.support.fileInput)
        .parent().addClass($.support.fileInput ? undefined : 'disabled');
});

    </script>
{% endblock %}